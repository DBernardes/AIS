
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../tutorial/">
      
      
        <link rel="next" href="../background_image/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Artificial Image Simulator - Artificial Image Simulator</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Artificial_Image_Simulator.artificial_image_simulator" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Artificial Image Simulator" class="md-header__button md-logo" aria-label="Artificial Image Simulator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Artificial Image Simulator
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Artificial Image Simulator
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/DBernardes/AIS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Dbernardes/AIS
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Artificial Image Simulator" class="md-nav__button md-logo" aria-label="Artificial Image Simulator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Artificial Image Simulator
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/DBernardes/AIS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Dbernardes/AIS
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quick_start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Artificial Image Simulator
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Artificial Image Simulator
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator" class="md-nav__link">
    <span class="md-ellipsis">
      artificial_image_simulator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator" class="md-nav__link">
    <span class="md-ellipsis">
      Artificial_Image_Simulator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Artificial_Image_Simulator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_Serkowski_curve" class="md-nav__link">
    <span class="md-ellipsis">
      apply_Serkowski_curve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_atmosphere_spectral_response" class="md-nav__link">
    <span class="md-ellipsis">
      apply_atmosphere_spectral_response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_circular_polarization" class="md-nav__link">
    <span class="md-ellipsis">
      apply_circular_polarization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_linear_polarization" class="md-nav__link">
    <span class="md-ellipsis">
      apply_linear_polarization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_polarization" class="md-nav__link">
    <span class="md-ellipsis">
      apply_polarization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_sparc4_spectral_response" class="md-nav__link">
    <span class="md-ellipsis">
      apply_sparc4_spectral_response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_telescope_spectral_response" class="md-nav__link">
    <span class="md-ellipsis">
      apply_telescope_spectral_response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.calculate_exposure_time" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_exposure_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_artificial_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_artificial_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_background_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_background_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_bias_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_bias_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_dark_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_dark_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_flat_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_flat_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_random_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_random_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_sky_sed" class="md-nav__link">
    <span class="md-ellipsis">
      create_sky_sed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_source_sed" class="md-nav__link">
    <span class="md-ellipsis">
      create_source_sed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.print_available_spectral_types" class="md-nav__link">
    <span class="md-ellipsis">
      print_available_spectral_types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.write_source_sed" class="md-nav__link">
    <span class="md-ellipsis">
      write_source_sed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../background_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Background Image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../header/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Header
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../noise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Noise
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../psf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PSF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SED
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spectral_response/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spectral Response
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors and contact
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator" class="md-nav__link">
    <span class="md-ellipsis">
      artificial_image_simulator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator" class="md-nav__link">
    <span class="md-ellipsis">
      Artificial_Image_Simulator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Artificial_Image_Simulator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_Serkowski_curve" class="md-nav__link">
    <span class="md-ellipsis">
      apply_Serkowski_curve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_atmosphere_spectral_response" class="md-nav__link">
    <span class="md-ellipsis">
      apply_atmosphere_spectral_response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_circular_polarization" class="md-nav__link">
    <span class="md-ellipsis">
      apply_circular_polarization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_linear_polarization" class="md-nav__link">
    <span class="md-ellipsis">
      apply_linear_polarization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_polarization" class="md-nav__link">
    <span class="md-ellipsis">
      apply_polarization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_sparc4_spectral_response" class="md-nav__link">
    <span class="md-ellipsis">
      apply_sparc4_spectral_response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_telescope_spectral_response" class="md-nav__link">
    <span class="md-ellipsis">
      apply_telescope_spectral_response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.calculate_exposure_time" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_exposure_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_artificial_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_artificial_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_background_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_background_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_bias_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_bias_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_dark_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_dark_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_flat_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_flat_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_random_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_random_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_sky_sed" class="md-nav__link">
    <span class="md-ellipsis">
      create_sky_sed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_source_sed" class="md-nav__link">
    <span class="md-ellipsis">
      create_source_sed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.print_available_spectral_types" class="md-nav__link">
    <span class="md-ellipsis">
      print_available_spectral_types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.write_source_sed" class="md-nav__link">
    <span class="md-ellipsis">
      write_source_sed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Artificial Image Simulator</h1>

<div class="doc doc-object doc-module">



<a id="Artificial_Image_Simulator.artificial_image_simulator"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator" class="doc doc-heading">
            <code>Artificial_Image_Simulator</code>


</h2>


    <div class="doc doc-contents ">


              <details class="quote">
                <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Artificial_Image_Simulator</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ccd_operation_mode</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">channel_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ccd_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ccd_operation_mode : dict[str,int | float | str]</span>
<span class="sd">            A python dictionary of the CCD operation mode.</span>
<span class="sd">            The allowed keywords are: em_mode, em_gain, preamp readout,</span>
<span class="sd">            binn, t_exp, and image_size.</span>
<span class="sd">        channel_id : [1, 2, 3, 4]</span>
<span class="sd">            Channel id.</span>
<span class="sd">        ccd_temperature : float | int</span>
<span class="sd">            CCD temperature.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        ```</span>
<span class="sd">        ccd_operation_mode = {</span>
<span class="sd">            &#39;em_mode&#39;: &#39;Conv&#39;,</span>
<span class="sd">            &#39;em_gain&#39;: 1,</span>
<span class="sd">            &#39;preamp&#39;: 1,</span>
<span class="sd">            &#39;readout&#39;: 1,</span>
<span class="sd">            &#39;binn&#39;: 1,</span>
<span class="sd">            &#39;t_exp&#39;: 1,</span>
<span class="sd">            &#39;image_size&#39;: 100</span>
<span class="sd">        }</span>
<span class="sd">        ais = Artificial_Image_Simulator(ccd_operation_mode,</span>
<span class="sd">                                        channel_id=1, ccd_temperature=-70)</span>
<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span> <span class="o">=</span> <span class="n">ccd_operation_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_id</span> <span class="o">=</span> <span class="n">channel_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ccd_temperature</span> <span class="o">=</span> <span class="n">ccd_temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verify_ccd_operation_mode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span> <span class="o">=</span> <span class="n">Background_Image</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">,</span> <span class="n">channel_id</span><span class="p">,</span> <span class="n">ccd_temperature</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span> <span class="o">=</span> <span class="n">Source</span><span class="p">()</span>  <span class="c1"># TODO isto eh injeção de dependencia</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SKY_obj</span> <span class="o">=</span> <span class="n">Sky</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ATM_obj</span> <span class="o">=</span> <span class="n">Atmosphere</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TEL_obj</span> <span class="o">=</span> <span class="n">Telescope</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CHNNL_obj</span> <span class="o">=</span> <span class="n">Channel</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PSF_obj</span> <span class="o">=</span> <span class="n">Point_Spread_Function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">,</span> <span class="n">channel_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span> <span class="o">=</span> <span class="n">Header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">,</span> <span class="n">ccd_temperature</span><span class="p">,</span> <span class="n">channel_id</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_verify_var_in_interval</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">var_max</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">var_min</span> <span class="o">&lt;=</span> <span class="n">var</span> <span class="o">&lt;=</span> <span class="n">var_max</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The </span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2"> must be in the interval [</span><span class="si">{</span><span class="n">var_min</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">var_max</span><span class="si">}</span><span class="s2">]: </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_verify_ccd_operation_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dic_keywords_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;binn&quot;</span><span class="p">,</span>
            <span class="s2">&quot;em_gain&quot;</span><span class="p">,</span>
            <span class="s2">&quot;em_mode&quot;</span><span class="p">,</span>
            <span class="s2">&quot;image_size&quot;</span><span class="p">,</span>
            <span class="s2">&quot;preamp&quot;</span><span class="p">,</span>
            <span class="s2">&quot;readout&quot;</span><span class="p">,</span>
            <span class="s2">&quot;t_exp&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic_keywords_list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The provided name is not a CCD parameter: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">keyvalues</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">keyvalues</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">keyvalues</span> <span class="o">!=</span> <span class="n">dic_keywords_list</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;There is a missing parameter for the CCD operation mode&quot;</span><span class="p">)</span>

        <span class="n">em_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;em_mode&quot;</span><span class="p">]</span>
        <span class="n">em_gain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;em_gain&quot;</span><span class="p">]</span>
        <span class="n">readout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;readout&quot;</span><span class="p">]</span>
        <span class="n">preamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;preamp&quot;</span><span class="p">]</span>
        <span class="n">binn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;binn&quot;</span><span class="p">]</span>
        <span class="n">t_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;t_exp&quot;</span><span class="p">]</span>
        <span class="n">image_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;image_size&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_var_in_a_list</span><span class="p">(</span><span class="n">em_mode</span><span class="p">,</span> <span class="s2">&quot;EM mode&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Conv&quot;</span><span class="p">,</span> <span class="s2">&quot;EM&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">em_mode</span> <span class="o">==</span> <span class="s2">&quot;Conv&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">em_gain</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The EM Gain must be 1 for the Conventional Mode: </span><span class="si">{</span><span class="n">em_gain</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_verify_var_in_interval</span><span class="p">(</span><span class="n">em_gain</span><span class="p">,</span> <span class="s2">&quot;EM Gain&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_var_in_a_list</span><span class="p">(</span><span class="n">readout</span><span class="p">,</span> <span class="s2">&quot;readout rate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_var_in_a_list</span><span class="p">(</span><span class="n">preamp</span><span class="p">,</span> <span class="s2">&quot;pre-amplification&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_var_in_a_list</span><span class="p">(</span><span class="n">binn</span><span class="p">,</span> <span class="s2">&quot;binning&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verify_var_in_interval</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="s2">&quot;image size&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="n">image_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verify_var_in_interval</span><span class="p">(</span><span class="n">t_exp</span><span class="p">,</span> <span class="s2">&quot;exposure time&quot;</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mi">84600</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_exp</span> <span class="o">=</span> <span class="n">t_exp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verify_var_in_interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccd_temperature</span><span class="p">,</span> <span class="s2">&quot;ccd temperature&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_var_in_a_list</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">_list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_list</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The allowed values for the </span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2"> are: </span><span class="si">{</span><span class="n">_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_source_sed</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">calculation_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">magnitude</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">wavelength_interval</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">temperature</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">spectral_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the Spectral Energy Distribution of the source.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        calculation_method : [&#39;blackbody&#39;, &#39;spectral_library&#39;]</span>
<span class="sd">            The method used to calculate the SED.</span>

<span class="sd">        magnitude : int | float</span>
<span class="sd">            The magnitude of the astronomical object in the V band.</span>

<span class="sd">        wavelength_interval : tuple, optional</span>
<span class="sd">            The wavelength interval, in nm, of the astronomical object.</span>
<span class="sd">            This parameter must be a tuple with three elements, where the first</span>
<span class="sd">            element is the initial wavelength, the second element is the final</span>
<span class="sd">            wavelength and the third element is the number of elements in the array.</span>
<span class="sd">            This parameter is used only if the calculation_method is &#39;blackbody&#39;.</span>

<span class="sd">        temperature : int | float, optional</span>
<span class="sd">            The blackbody temperature of the astronomical object in Kelvin.</span>
<span class="sd">            This parameter is used only if the calculation_method is &#39;blackbody&#39;.</span>

<span class="sd">        spectral_type : str, optional</span>
<span class="sd">            The spectral type of the star that will be used to calculate the SED.</span>
<span class="sd">            This parameter is used only if the calculation_method is &#39;spectral_standard&#39;.</span>
<span class="sd">            The available spectral types can be found using the</span>
<span class="sd">            `print_available_spectral_types()` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">calculate_sed</span><span class="p">(</span>
            <span class="n">calculation_method</span><span class="p">,</span>
            <span class="n">magnitude</span><span class="p">,</span>
            <span class="n">wavelength_interval</span><span class="p">,</span>
            <span class="n">temperature</span><span class="p">,</span>
            <span class="n">spectral_type</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply_linear_polarization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">percent_pol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">pol_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a linear polarization to the SED of the object and the sky.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        percent_pol: float, optional</span>
<span class="sd">            Percentage of polarization.</span>
<span class="sd">        pol_angle: float, optional</span>
<span class="sd">            Polarization angle in degrees. If the selected polarization mode were</span>
<span class="sd">            linear, the polarization angle must be provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">apply_linear_polarization</span><span class="p">(</span><span class="n">percent_pol</span><span class="p">,</span> <span class="n">pol_angle</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply_circular_polarization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">percent_pol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">orientation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply ciruclar polarization in SED.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        percent_pol: float, optional</span>
<span class="sd">            Percentage of polarization.</span>
<span class="sd">        orientation: [&#39;right&#39;, &#39;left&#39;], optional</span>
<span class="sd">            Orientation of the polarization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">apply_circular_polarization</span><span class="p">(</span>
            <span class="n">percent_pol</span><span class="p">,</span> <span class="n">orientation</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply_polarization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stokes</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a generic polarization to the SED.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stokes: list, optional</span>
<span class="sd">            A list with the q, u, and v Stokes parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">apply_polarization</span><span class="p">(</span><span class="n">stokes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply_Serkowski_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pol_BVRI</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply the Serkowski curve to the SED of the star.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pol_BVRI : dict</span>
<span class="sd">            A python dictionary containing the polarization values of the filters BVRI</span>
<span class="sd">            in percentage.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        ```</span>
<span class="sd">        pol_BVRI = {&#39;B&#39;:8, &#39;V&#39;: 8.5, &#39;R&#39;: 7.2, &#39;I&#39;:6}</span>
<span class="sd">        AIS.apply_Serkowski_curve(pol.BVRI)</span>
<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">apply_Serkowski_curve</span><span class="p">(</span><span class="n">pol_BVRI</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">write_source_sed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">sed</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a customized source SED into the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelength: array like</span>
<span class="sd">            The wavelength interval of the source in nm.</span>
<span class="sd">        sed: array like</span>
<span class="sd">            Spectral Energy Distribution of the source in W/(m2.m).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">sed</span><span class="o">.</span><span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="n">sed</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">print_available_spectral_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the available spectral types.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">print_available_spectral_types</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">create_sky_sed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moon_phase</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the Spectral Energy Distribution of the sky.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        moon_phase : [&#39;new&#39;, &#39;first quarter&#39;, &#39;third quarter&#39;, &#39;full&#39;]</span>
<span class="sd">            The phase of the moon.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SKY_obj</span><span class="o">.</span><span class="n">calculate_sed</span><span class="p">(</span><span class="n">moon_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply_atmosphere_spectral_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">air_mass</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">sky_condition</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;photometric&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply the atmosphere spectral response.</span>

<span class="sd">        This functions applies the atmosphere spectral response on the</span>
<span class="sd">        Spectral Energy Distribution of the source and the sky.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        air_mass: 1.0, optional</span>
<span class="sd">            The air mass in the light path.</span>
<span class="sd">        sky_condition: [&quot;photometric&quot;, &quot;regular&quot;, &quot;good&quot;], optional</span>
<span class="sd">            The sky condition. According to the value provided for this variable,</span>
<span class="sd">            a different extinction coeficient for the atmosphere will be selected.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ATM_obj</span><span class="o">.</span><span class="n">apply_spectral_response</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span><span class="p">,</span> <span class="n">air_mass</span><span class="p">,</span> <span class="n">sky_condition</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply_telescope_spectral_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="s2">&quot;20230329&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply the telescope spectral response.</span>

<span class="sd">        This functions applies the telescope spectral response to the</span>
<span class="sd">        Spectral Energy Distribution of the source and the sky.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        date: [&#39;20230329&#39;, &#39;20230328&#39;], optional</span>
<span class="sd">            Date of the transmission curve of the telescope.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEL_obj</span><span class="o">.</span><span class="n">apply_spectral_response</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span><span class="p">,</span> <span class="n">date</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEL_obj</span><span class="o">.</span><span class="n">apply_spectral_response</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span><span class="p">,</span> <span class="n">date</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply_sparc4_spectral_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">acquisition_mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">calibration_wheel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">retarder_waveplate</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;half&quot;</span><span class="p">,</span>
        <span class="n">retarder_waveplate_angle</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply the SPARC4 spectral response.</span>

<span class="sd">        This functions applies the SPARC4 spectral response to the</span>
<span class="sd">        Spectral Energy Distribution of the source and the sky.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        acquisition_mode: [&quot;photometry&quot;, &quot;polarimetry&quot;]</span>
<span class="sd">            The acquisition mode of the sparc4.</span>

<span class="sd">        calibration_wheel: [&quot;polarizer&quot;, &quot;ideal-polarizer&quot;, &quot;ideal-depolarizer&quot;], optional.</span>
<span class="sd">            The optical component of the calibration wheel.</span>
<span class="sd">            This parameter provides to the user the options of using the real or the</span>
<span class="sd">            ideal versions of the optical components of the calibration wheel.</span>
<span class="sd">            Based on the provided value, AIS will apply the correspondent Stoke matrix.</span>
<span class="sd">            It should be highlighted that the transmission of the optical component</span>
<span class="sd">            still be applied.</span>

<span class="sd">        retarder_waveplate: [&quot;half&quot;, &quot;quarter&quot;], optional</span>
<span class="sd">            The waveplate for polarimetric measurements.</span>
<span class="sd">            This parameter is used only if the acquisition_mode is &#39;polarimetry&#39;.</span>

<span class="sd">        retarder_waveplate_angle: int | float, optional</span>
<span class="sd">            The angle of the retarder waveplate in degrees.</span>
<span class="sd">            If the acquisition mode of SPARC4 is polarimetry,</span>
<span class="sd">            the retarder waveplate angle should be provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CHNNL_obj</span><span class="o">.</span><span class="n">write_sparc4_operation_mode</span><span class="p">(</span>
            <span class="n">acquisition_mode</span><span class="p">,</span>
            <span class="n">calibration_wheel</span><span class="p">,</span>
            <span class="n">retarder_waveplate</span><span class="p">,</span>
            <span class="n">retarder_waveplate_angle</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CHNNL_obj</span><span class="o">.</span><span class="n">apply_spectral_response</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CHNNL_obj</span><span class="o">.</span><span class="n">apply_spectral_response</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_integrate_sed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">*=</span> <span class="mf">1e-9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_exposure_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seeing</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the exposure time required for a given Signal-to-Noise Ratio.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        snr: float, optional</span>
<span class="sd">            Signal-to-noise ratio. Defaults to 100.</span>
<span class="sd">        seeing: float, optional</span>
<span class="sd">            Seeing of the object. Defaults to 1.5.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            float</span>
<span class="sd">                The minimum exposure time required to meet the provided SNR.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_pix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PSF_obj</span><span class="o">.</span><span class="n">calculate_npix_star</span><span class="p">(</span><span class="n">seeing</span><span class="p">)</span>
        <span class="n">noise_obj</span> <span class="o">=</span> <span class="n">Noise</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_id</span><span class="p">)</span>
        <span class="n">dark_noise</span> <span class="o">=</span> <span class="n">noise_obj</span><span class="o">.</span><span class="n">calculate_dark_current</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccd_temperature</span><span class="p">)</span>
        <span class="n">read_noise</span> <span class="o">=</span> <span class="n">noise_obj</span><span class="o">.</span><span class="n">calculate_read_noise</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">)</span>

        <span class="n">noise_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">em_gain</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">binn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;binn&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;em_mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;EM&quot;</span><span class="p">:</span>
            <span class="n">noise_factor</span> <span class="o">=</span> <span class="mf">1.4</span>
            <span class="n">em_gain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;em_gain&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_integrate_sed</span><span class="p">()</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">snr</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">*</span> <span class="n">noise_factor</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span>
                <span class="o">+</span> <span class="n">n_pix</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span> <span class="o">+</span> <span class="n">dark_noise</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">snr</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n_pix</span> <span class="o">*</span> <span class="p">(</span><span class="n">read_noise</span> <span class="o">/</span> <span class="n">em_gain</span> <span class="o">/</span> <span class="n">binn</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="n">texp_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_second_degree_eq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">)</span>
        <span class="n">min_t_exp</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">texp</span> <span class="k">for</span> <span class="n">texp</span> <span class="ow">in</span> <span class="n">texp_list</span> <span class="k">if</span> <span class="n">texp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">min_t_exp</span>

    <span class="k">def</span> <span class="nf">create_artificial_image</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">star_coordinates</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
        <span class="n">seeing</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an artificial image.</span>

<span class="sd">        This function creates a FITS file of an artificial image, similator to those</span>
<span class="sd">        acquired using the SPARC4 scientific cameras.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image_path : str</span>
<span class="sd">            The path where the FITS file will be saved.</span>
<span class="sd">        star_coordinates : tuple</span>
<span class="sd">            The coordinates in pixels of the star in the image.</span>
<span class="sd">        seeing : float, optional</span>
<span class="sd">            The seeing of the star.</span>
<span class="sd">        seed: float, optinal.</span>
<span class="sd">            The seed used to create the image. Default to 1.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_integrate_sed</span><span class="p">()</span>
        <span class="n">ord_ray</span><span class="p">,</span> <span class="n">extra_ord_ray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span><span class="p">)</span>
            <span class="n">ord_ray</span><span class="p">,</span> <span class="n">extra_ord_ray</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="n">background</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_sky_background</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span><span class="p">,</span> <span class="n">seed</span>
        <span class="p">)</span>
        <span class="n">star_psf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PSF_obj</span><span class="o">.</span><span class="n">create_star_image</span><span class="p">(</span>
            <span class="n">star_coordinates</span><span class="p">,</span> <span class="n">ord_ray</span><span class="p">,</span> <span class="n">extra_ord_ray</span><span class="p">,</span> <span class="n">seeing</span><span class="p">,</span> <span class="n">seed</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OBJECT&quot;</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;SHUTTER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OPEN&quot;</span>

        <span class="n">image</span> <span class="o">=</span> <span class="n">background</span> <span class="o">+</span> <span class="n">star_psf</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>
        <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
            <span class="n">file</span><span class="p">,</span>
            <span class="n">image</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_background_image</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">images</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a background image.</span>

<span class="sd">        This function creates an image of the sky background.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image_path : str</span>
<span class="sd">            The path where the FITS file will be saved.</span>
<span class="sd">        images : int, optional</span>
<span class="sd">            The number of images to be created. The default is 1.</span>
<span class="sd">        seed: float, optinal.</span>
<span class="sd">            The seed used to create the image. Default to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">images</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of images must be greater than 0.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_integrate_sed</span><span class="p">()</span>
            <span class="n">background</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_sky_background</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span><span class="p">,</span> <span class="n">seed</span>
            <span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;FLAT&quot;</span>  <span class="c1"># ?</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;SHUTTER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OPEN&quot;</span>

            <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>

            <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">background</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_dark_image</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">images</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a dark image.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image_path : str</span>
<span class="sd">            The path where the FITS file will be saved.</span>
<span class="sd">        images : int, optional</span>
<span class="sd">            The number of dark images to be created. The default is 1.</span>
<span class="sd">        seed: float, optinal.</span>
<span class="sd">            The seed used to create the image. Default to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">images</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of images must be greater than 0.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
            <span class="n">dark_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_dark_background</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DARK&quot;</span>
            <span class="n">image_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>

            <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
                <span class="n">image_name</span><span class="p">,</span>
                <span class="n">dark_image</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_bias_image</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">images</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a bias image.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image_path : str</span>
<span class="sd">            The path where the FITS file will be saved.</span>
<span class="sd">        images : int, optional</span>
<span class="sd">            The number of bias images to be created. The default is 1.</span>
<span class="sd">        seed: float, optinal.</span>
<span class="sd">            The seed used to create the image. Default to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">images</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of images must be greater than 0.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
            <span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_bias_background</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;EXPTIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-5</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ZERO&quot;</span>

            <span class="n">image_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>

            <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
                <span class="n">image_name</span><span class="p">,</span>
                <span class="n">bias</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_random_image</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">,</span> <span class="n">number_stars</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">seeing</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a random star image.</span>

<span class="sd">        This function creates an artificial image with a set of random stars.</span>
<span class="sd">        The number of star created by the function can be provided to the class.</span>
<span class="sd">        Otherwise, the number 10 will be used.</span>
<span class="sd">        Then, all the star images will be sumed with the background image.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image_path : str</span>
<span class="sd">            The path where the FITS file will be saved.</span>
<span class="sd">        number_stars: int, optional</span>
<span class="sd">            The number of stars in the image.</span>
<span class="sd">        seeing : float, optional</span>
<span class="sd">            The seeing of the star.</span>
<span class="sd">        seed: float, optinal.</span>
<span class="sd">            The seed used to create the image. Default to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_integrate_sed</span><span class="p">()</span>
        <span class="n">ord_ray</span><span class="p">,</span> <span class="n">extra_ord_ray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span><span class="p">)</span>
            <span class="n">ord_ray</span><span class="p">,</span> <span class="n">extra_ord_ray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span>

        <span class="n">image_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;image_size&quot;</span><span class="p">]</span>
        <span class="n">star_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_stars</span><span class="p">):</span>
            <span class="n">x_coord</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">image_size</span><span class="p">)</span>
            <span class="n">y_coord</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">image_size</span><span class="p">)</span>
            <span class="n">ordinary_ray</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ord_ray</span><span class="p">)</span>
            <span class="n">extra_ordinary_ray</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">extra_ord_ray</span><span class="p">)</span>
            <span class="n">star_image</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PSF_obj</span><span class="o">.</span><span class="n">create_star_image</span><span class="p">(</span>
                <span class="p">(</span><span class="n">x_coord</span><span class="p">,</span> <span class="n">y_coord</span><span class="p">),</span>
                <span class="n">ordinary_ray</span><span class="p">,</span>
                <span class="n">extra_ordinary_ray</span><span class="p">,</span>
                <span class="n">seeing</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">background</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_sky_background</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OBJECT&quot;</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;SHUTTER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OPEN&quot;</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>
        <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
            <span class="n">file</span><span class="p">,</span>
            <span class="n">background</span> <span class="o">+</span> <span class="n">star_image</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_flat_image</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">images</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a flat image.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image_path : str</span>
<span class="sd">            The path where the FITS file will be saved.</span>
<span class="sd">        images : int, optional</span>
<span class="sd">            The number of flat images to be created. The default is 1.</span>
<span class="sd">        seed: float, optinal.</span>
<span class="sd">            The seed used to create the image. Default to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">images</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of images must be greater than 0.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
            <span class="n">flat_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_flat_background</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;FLAT&quot;</span>
            <span class="n">header</span><span class="p">[</span><span class="s2">&quot;SHUTTER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OPEN&quot;</span>

            <span class="n">image_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>

            <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
                <span class="n">image_name</span><span class="p">,</span>
                <span class="n">flat_image</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_find_image_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">image_path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.fits&quot;</span><span class="p">):</span>
                <span class="n">new_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">new_index</span> <span class="o">&gt;</span> <span class="n">index</span><span class="p">:</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="n">new_index</span>
        <span class="k">return</span> <span class="n">index</span>

    <span class="k">def</span> <span class="nf">_create_image_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_image_index</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;%Y%m%d_s4c</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">:</span><span class="s2">06</span><span class="si">}</span><span class="s2">.fits&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_solve_second_degree_eq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ccd_operation_mode</span><span class="p">,</span> <span class="n">channel_id</span><span class="p">,</span> <span class="n">ccd_temperature</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Initialize the class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>ccd_operation_mode</code></td>
            <td>
                  <code>dict[str, int | float | str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A python dictionary of the CCD operation mode.
The allowed keywords are: em_mode, em_gain, preamp readout,
binn, t_exp, and image_size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>channel_id</code></td>
            <td>
                  <code>[1, 2, 3, 4]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Channel id.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>ccd_temperature</code></td>
            <td>
                  <code>float | int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CCD temperature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code>ccd_operation_mode = {
    &#39;em_mode&#39;: &#39;Conv&#39;,
    &#39;em_gain&#39;: 1,
    &#39;preamp&#39;: 1,
    &#39;readout&#39;: 1,
    &#39;binn&#39;: 1,
    &#39;t_exp&#39;: 1,
    &#39;image_size&#39;: 100
}
ais = Artificial_Image_Simulator(ccd_operation_mode,
                                channel_id=1, ccd_temperature=-70)
</code></pre></div>
</details>
            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ccd_operation_mode</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">channel_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ccd_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ccd_operation_mode : dict[str,int | float | str]</span>
<span class="sd">        A python dictionary of the CCD operation mode.</span>
<span class="sd">        The allowed keywords are: em_mode, em_gain, preamp readout,</span>
<span class="sd">        binn, t_exp, and image_size.</span>
<span class="sd">    channel_id : [1, 2, 3, 4]</span>
<span class="sd">        Channel id.</span>
<span class="sd">    ccd_temperature : float | int</span>
<span class="sd">        CCD temperature.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>

<span class="sd">    ```</span>
<span class="sd">    ccd_operation_mode = {</span>
<span class="sd">        &#39;em_mode&#39;: &#39;Conv&#39;,</span>
<span class="sd">        &#39;em_gain&#39;: 1,</span>
<span class="sd">        &#39;preamp&#39;: 1,</span>
<span class="sd">        &#39;readout&#39;: 1,</span>
<span class="sd">        &#39;binn&#39;: 1,</span>
<span class="sd">        &#39;t_exp&#39;: 1,</span>
<span class="sd">        &#39;image_size&#39;: 100</span>
<span class="sd">    }</span>
<span class="sd">    ais = Artificial_Image_Simulator(ccd_operation_mode,</span>
<span class="sd">                                    channel_id=1, ccd_temperature=-70)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span> <span class="o">=</span> <span class="n">ccd_operation_mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channel_id</span> <span class="o">=</span> <span class="n">channel_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ccd_temperature</span> <span class="o">=</span> <span class="n">ccd_temperature</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_verify_ccd_operation_mode</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span> <span class="o">=</span> <span class="n">Background_Image</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">,</span> <span class="n">channel_id</span><span class="p">,</span> <span class="n">ccd_temperature</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span> <span class="o">=</span> <span class="n">Source</span><span class="p">()</span>  <span class="c1"># TODO isto eh injeção de dependencia</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">SKY_obj</span> <span class="o">=</span> <span class="n">Sky</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ATM_obj</span> <span class="o">=</span> <span class="n">Atmosphere</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">TEL_obj</span> <span class="o">=</span> <span class="n">Telescope</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CHNNL_obj</span> <span class="o">=</span> <span class="n">Channel</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PSF_obj</span> <span class="o">=</span> <span class="n">Point_Spread_Function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">,</span> <span class="n">channel_id</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span> <span class="o">=</span> <span class="n">Header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">,</span> <span class="n">ccd_temperature</span><span class="p">,</span> <span class="n">channel_id</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_Serkowski_curve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_Serkowski_curve</span><span class="p">(</span><span class="n">pol_BVRI</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Apply the Serkowski curve to the SED of the star.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pol_BVRI</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A python dictionary containing the polarization values of the filters BVRI
in percentage.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code>pol_BVRI = {&#39;B&#39;:8, &#39;V&#39;: 8.5, &#39;R&#39;: 7.2, &#39;I&#39;:6}
AIS.apply_Serkowski_curve(pol.BVRI)
</code></pre></div>
</details>
            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_Serkowski_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pol_BVRI</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply the Serkowski curve to the SED of the star.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pol_BVRI : dict</span>
<span class="sd">        A python dictionary containing the polarization values of the filters BVRI</span>
<span class="sd">        in percentage.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    ```</span>
<span class="sd">    pol_BVRI = {&#39;B&#39;:8, &#39;V&#39;: 8.5, &#39;R&#39;: 7.2, &#39;I&#39;:6}</span>
<span class="sd">    AIS.apply_Serkowski_curve(pol.BVRI)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">apply_Serkowski_curve</span><span class="p">(</span><span class="n">pol_BVRI</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_atmosphere_spectral_response" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_atmosphere_spectral_response</span><span class="p">(</span><span class="n">air_mass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sky_condition</span><span class="o">=</span><span class="s1">&#39;photometric&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Apply the atmosphere spectral response.</p>
<p>This functions applies the atmosphere spectral response on the
Spectral Energy Distribution of the source and the sky.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>air_mass</code></td>
            <td>
                  <code>int | float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The air mass in the light path.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sky_condition</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sky condition. According to the value provided for this variable,
a different extinction coeficient for the atmosphere will be selected.</p>
              </div>
            </td>
            <td>
                  <code>&#39;photometric&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_atmosphere_spectral_response</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">air_mass</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">sky_condition</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;photometric&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply the atmosphere spectral response.</span>

<span class="sd">    This functions applies the atmosphere spectral response on the</span>
<span class="sd">    Spectral Energy Distribution of the source and the sky.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    air_mass: 1.0, optional</span>
<span class="sd">        The air mass in the light path.</span>
<span class="sd">    sky_condition: [&quot;photometric&quot;, &quot;regular&quot;, &quot;good&quot;], optional</span>
<span class="sd">        The sky condition. According to the value provided for this variable,</span>
<span class="sd">        a different extinction coeficient for the atmosphere will be selected.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ATM_obj</span><span class="o">.</span><span class="n">apply_spectral_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span><span class="p">,</span> <span class="n">air_mass</span><span class="p">,</span> <span class="n">sky_condition</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_circular_polarization" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_circular_polarization</span><span class="p">(</span><span class="n">percent_pol</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Apply ciruclar polarization in SED.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>percent_pol</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Percentage of polarization.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>orientation</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Orientation of the polarization.</p>
              </div>
            </td>
            <td>
                  <code>&#39;left&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_circular_polarization</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">percent_pol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">orientation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply ciruclar polarization in SED.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    percent_pol: float, optional</span>
<span class="sd">        Percentage of polarization.</span>
<span class="sd">    orientation: [&#39;right&#39;, &#39;left&#39;], optional</span>
<span class="sd">        Orientation of the polarization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">apply_circular_polarization</span><span class="p">(</span>
        <span class="n">percent_pol</span><span class="p">,</span> <span class="n">orientation</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_linear_polarization" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_linear_polarization</span><span class="p">(</span><span class="n">percent_pol</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pol_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Apply a linear polarization to the SED of the object and the sky.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>percent_pol</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Percentage of polarization.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>pol_angle</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Polarization angle in degrees. If the selected polarization mode were
linear, the polarization angle must be provided.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_linear_polarization</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">percent_pol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">pol_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a linear polarization to the SED of the object and the sky.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    percent_pol: float, optional</span>
<span class="sd">        Percentage of polarization.</span>
<span class="sd">    pol_angle: float, optional</span>
<span class="sd">        Polarization angle in degrees. If the selected polarization mode were</span>
<span class="sd">        linear, the polarization angle must be provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">apply_linear_polarization</span><span class="p">(</span><span class="n">percent_pol</span><span class="p">,</span> <span class="n">pol_angle</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_polarization" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_polarization</span><span class="p">(</span><span class="n">stokes</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Apply a generic polarization to the SED.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>stokes</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list with the q, u, and v Stokes parameters.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_polarization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stokes</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a generic polarization to the SED.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    stokes: list, optional</span>
<span class="sd">        A list with the q, u, and v Stokes parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">apply_polarization</span><span class="p">(</span><span class="n">stokes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_sparc4_spectral_response" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_sparc4_spectral_response</span><span class="p">(</span><span class="n">acquisition_mode</span><span class="p">,</span> <span class="n">calibration_wheel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">retarder_waveplate</span><span class="o">=</span><span class="s1">&#39;half&#39;</span><span class="p">,</span> <span class="n">retarder_waveplate_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Apply the SPARC4 spectral response.</p>
<p>This functions applies the SPARC4 spectral response to the
Spectral Energy Distribution of the source and the sky.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>acquisition_mode</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The acquisition mode of the sparc4.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>calibration_wheel</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optical component of the calibration wheel.
This parameter provides to the user the options of using the real or the
ideal versions of the optical components of the calibration wheel.
Based on the provided value, AIS will apply the correspondent Stoke matrix.
It should be highlighted that the transmission of the optical component
still be applied.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>retarder_waveplate</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The waveplate for polarimetric measurements.
This parameter is used only if the acquisition_mode is 'polarimetry'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;half&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>retarder_waveplate_angle</code></td>
            <td>
                  <code>int | float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The angle of the retarder waveplate in degrees.
If the acquisition mode of SPARC4 is polarimetry,
the retarder waveplate angle should be provided.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_sparc4_spectral_response</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">acquisition_mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">calibration_wheel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">retarder_waveplate</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;half&quot;</span><span class="p">,</span>
    <span class="n">retarder_waveplate_angle</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply the SPARC4 spectral response.</span>

<span class="sd">    This functions applies the SPARC4 spectral response to the</span>
<span class="sd">    Spectral Energy Distribution of the source and the sky.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    acquisition_mode: [&quot;photometry&quot;, &quot;polarimetry&quot;]</span>
<span class="sd">        The acquisition mode of the sparc4.</span>

<span class="sd">    calibration_wheel: [&quot;polarizer&quot;, &quot;ideal-polarizer&quot;, &quot;ideal-depolarizer&quot;], optional.</span>
<span class="sd">        The optical component of the calibration wheel.</span>
<span class="sd">        This parameter provides to the user the options of using the real or the</span>
<span class="sd">        ideal versions of the optical components of the calibration wheel.</span>
<span class="sd">        Based on the provided value, AIS will apply the correspondent Stoke matrix.</span>
<span class="sd">        It should be highlighted that the transmission of the optical component</span>
<span class="sd">        still be applied.</span>

<span class="sd">    retarder_waveplate: [&quot;half&quot;, &quot;quarter&quot;], optional</span>
<span class="sd">        The waveplate for polarimetric measurements.</span>
<span class="sd">        This parameter is used only if the acquisition_mode is &#39;polarimetry&#39;.</span>

<span class="sd">    retarder_waveplate_angle: int | float, optional</span>
<span class="sd">        The angle of the retarder waveplate in degrees.</span>
<span class="sd">        If the acquisition mode of SPARC4 is polarimetry,</span>
<span class="sd">        the retarder waveplate angle should be provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CHNNL_obj</span><span class="o">.</span><span class="n">write_sparc4_operation_mode</span><span class="p">(</span>
        <span class="n">acquisition_mode</span><span class="p">,</span>
        <span class="n">calibration_wheel</span><span class="p">,</span>
        <span class="n">retarder_waveplate</span><span class="p">,</span>
        <span class="n">retarder_waveplate_angle</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CHNNL_obj</span><span class="o">.</span><span class="n">apply_spectral_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CHNNL_obj</span><span class="o">.</span><span class="n">apply_spectral_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.apply_telescope_spectral_response" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_telescope_spectral_response</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="s1">&#39;20230329&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Apply the telescope spectral response.</p>
<p>This functions applies the telescope spectral response to the
Spectral Energy Distribution of the source and the sky.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>date</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date of the transmission curve of the telescope.</p>
              </div>
            </td>
            <td>
                  <code>&#39;20230329&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_telescope_spectral_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="s2">&quot;20230329&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply the telescope spectral response.</span>

<span class="sd">    This functions applies the telescope spectral response to the</span>
<span class="sd">    Spectral Energy Distribution of the source and the sky.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    date: [&#39;20230329&#39;, &#39;20230328&#39;], optional</span>
<span class="sd">        Date of the transmission curve of the telescope.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEL_obj</span><span class="o">.</span><span class="n">apply_spectral_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span><span class="p">,</span> <span class="n">date</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEL_obj</span><span class="o">.</span><span class="n">apply_spectral_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span><span class="p">,</span> <span class="n">date</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.calculate_exposure_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_exposure_time</span><span class="p">(</span><span class="n">snr</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">seeing</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Calculate the exposure time required for a given Signal-to-Noise Ratio.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>snr</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Signal-to-noise ratio. Defaults to 100.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seeing</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seeing of the object. Defaults to 1.5.</p>
              </div>
            </td>
            <td>
                  <code>1.5</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum exposure time required to meet the provided SNR.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_exposure_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seeing</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the exposure time required for a given Signal-to-Noise Ratio.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    snr: float, optional</span>
<span class="sd">        Signal-to-noise ratio. Defaults to 100.</span>
<span class="sd">    seeing: float, optional</span>
<span class="sd">        Seeing of the object. Defaults to 1.5.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        float</span>
<span class="sd">            The minimum exposure time required to meet the provided SNR.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_pix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PSF_obj</span><span class="o">.</span><span class="n">calculate_npix_star</span><span class="p">(</span><span class="n">seeing</span><span class="p">)</span>
    <span class="n">noise_obj</span> <span class="o">=</span> <span class="n">Noise</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_id</span><span class="p">)</span>
    <span class="n">dark_noise</span> <span class="o">=</span> <span class="n">noise_obj</span><span class="o">.</span><span class="n">calculate_dark_current</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccd_temperature</span><span class="p">)</span>
    <span class="n">read_noise</span> <span class="o">=</span> <span class="n">noise_obj</span><span class="o">.</span><span class="n">calculate_read_noise</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">)</span>

    <span class="n">noise_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">em_gain</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">binn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;binn&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;em_mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;EM&quot;</span><span class="p">:</span>
        <span class="n">noise_factor</span> <span class="o">=</span> <span class="mf">1.4</span>
        <span class="n">em_gain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;em_gain&quot;</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_integrate_sed</span><span class="p">()</span>
    <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">snr</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">*</span> <span class="n">noise_factor</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">*</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span>
            <span class="o">+</span> <span class="n">n_pix</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span> <span class="o">+</span> <span class="n">dark_noise</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">snr</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n_pix</span> <span class="o">*</span> <span class="p">(</span><span class="n">read_noise</span> <span class="o">/</span> <span class="n">em_gain</span> <span class="o">/</span> <span class="n">binn</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="n">texp_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_second_degree_eq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">)</span>
    <span class="n">min_t_exp</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">texp</span> <span class="k">for</span> <span class="n">texp</span> <span class="ow">in</span> <span class="n">texp_list</span> <span class="k">if</span> <span class="n">texp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">min_t_exp</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_artificial_image" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_artificial_image</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">star_coordinates</span><span class="p">,</span> <span class="n">seeing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Create an artificial image.</p>
<p>This function creates a FITS file of an artificial image, similator to those
acquired using the SPARC4 scientific cameras.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>image_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path where the FITS file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>star_coordinates</code></td>
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The coordinates in pixels of the star in the image.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seeing</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The seeing of the star.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seed</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The seed used to create the image. Default to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_artificial_image</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">star_coordinates</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
    <span class="n">seeing</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an artificial image.</span>

<span class="sd">    This function creates a FITS file of an artificial image, similator to those</span>
<span class="sd">    acquired using the SPARC4 scientific cameras.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    image_path : str</span>
<span class="sd">        The path where the FITS file will be saved.</span>
<span class="sd">    star_coordinates : tuple</span>
<span class="sd">        The coordinates in pixels of the star in the image.</span>
<span class="sd">    seeing : float, optional</span>
<span class="sd">        The seeing of the star.</span>
<span class="sd">    seed: float, optinal.</span>
<span class="sd">        The seed used to create the image. Default to 1.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_integrate_sed</span><span class="p">()</span>
    <span class="n">ord_ray</span><span class="p">,</span> <span class="n">extra_ord_ray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span><span class="p">)</span>
        <span class="n">ord_ray</span><span class="p">,</span> <span class="n">extra_ord_ray</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="n">background</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_sky_background</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span><span class="p">,</span> <span class="n">seed</span>
    <span class="p">)</span>
    <span class="n">star_psf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PSF_obj</span><span class="o">.</span><span class="n">create_star_image</span><span class="p">(</span>
        <span class="n">star_coordinates</span><span class="p">,</span> <span class="n">ord_ray</span><span class="p">,</span> <span class="n">extra_ord_ray</span><span class="p">,</span> <span class="n">seeing</span><span class="p">,</span> <span class="n">seed</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
    <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
    <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OBJECT&quot;</span>
    <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
    <span class="n">header</span><span class="p">[</span><span class="s2">&quot;SHUTTER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OPEN&quot;</span>

    <span class="n">image</span> <span class="o">=</span> <span class="n">background</span> <span class="o">+</span> <span class="n">star_psf</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
        <span class="n">file</span><span class="p">,</span>
        <span class="n">image</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_background_image" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_background_image</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">images</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Create a background image.</p>
<p>This function creates an image of the sky background.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>image_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path where the FITS file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>images</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of images to be created. The default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seed</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The seed used to create the image. Default to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_background_image</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">images</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a background image.</span>

<span class="sd">    This function creates an image of the sky background.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    image_path : str</span>
<span class="sd">        The path where the FITS file will be saved.</span>
<span class="sd">    images : int, optional</span>
<span class="sd">        The number of images to be created. The default is 1.</span>
<span class="sd">    seed: float, optinal.</span>
<span class="sd">        The seed used to create the image. Default to 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">images</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of images must be greater than 0.&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_integrate_sed</span><span class="p">()</span>
        <span class="n">background</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_sky_background</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span><span class="p">,</span> <span class="n">seed</span>
        <span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;FLAT&quot;</span>  <span class="c1"># ?</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;SHUTTER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OPEN&quot;</span>

        <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>

        <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">background</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_bias_image" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_bias_image</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">images</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Create a bias image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>image_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path where the FITS file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>images</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of bias images to be created. The default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seed</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The seed used to create the image. Default to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_bias_image</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">images</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a bias image.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    image_path : str</span>
<span class="sd">        The path where the FITS file will be saved.</span>
<span class="sd">    images : int, optional</span>
<span class="sd">        The number of bias images to be created. The default is 1.</span>
<span class="sd">    seed: float, optinal.</span>
<span class="sd">        The seed used to create the image. Default to 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">images</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of images must be greater than 0.&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
        <span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_bias_background</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;EXPTIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-5</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ZERO&quot;</span>

        <span class="n">image_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>

        <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
            <span class="n">image_name</span><span class="p">,</span>
            <span class="n">bias</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_dark_image" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_dark_image</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">images</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Create a dark image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>image_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path where the FITS file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>images</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of dark images to be created. The default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seed</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The seed used to create the image. Default to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_dark_image</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">images</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a dark image.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    image_path : str</span>
<span class="sd">        The path where the FITS file will be saved.</span>
<span class="sd">    images : int, optional</span>
<span class="sd">        The number of dark images to be created. The default is 1.</span>
<span class="sd">    seed: float, optinal.</span>
<span class="sd">        The seed used to create the image. Default to 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">images</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of images must be greater than 0.&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
        <span class="n">dark_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_dark_background</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DARK&quot;</span>
        <span class="n">image_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>

        <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
            <span class="n">image_name</span><span class="p">,</span>
            <span class="n">dark_image</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_flat_image" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_flat_image</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">images</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Create a flat image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>image_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path where the FITS file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>images</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of flat images to be created. The default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seed</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The seed used to create the image. Default to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_flat_image</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">images</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a flat image.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    image_path : str</span>
<span class="sd">        The path where the FITS file will be saved.</span>
<span class="sd">    images : int, optional</span>
<span class="sd">        The number of flat images to be created. The default is 1.</span>
<span class="sd">    seed: float, optinal.</span>
<span class="sd">        The seed used to create the image. Default to 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">images</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of images must be greater than 0.&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
        <span class="n">flat_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_flat_background</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;FLAT&quot;</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;SHUTTER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OPEN&quot;</span>

        <span class="n">image_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>

        <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
            <span class="n">image_name</span><span class="p">,</span>
            <span class="n">flat_image</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_random_image" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_random_image</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">number_stars</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">seeing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Create a random star image.</p>
<p>This function creates an artificial image with a set of random stars.
The number of star created by the function can be provided to the class.
Otherwise, the number 10 will be used.
Then, all the star images will be sumed with the background image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>image_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path where the FITS file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>number_stars</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of stars in the image.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seeing</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The seeing of the star.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seed</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The seed used to create the image. Default to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_random_image</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">,</span> <span class="n">number_stars</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">seeing</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a random star image.</span>

<span class="sd">    This function creates an artificial image with a set of random stars.</span>
<span class="sd">    The number of star created by the function can be provided to the class.</span>
<span class="sd">    Otherwise, the number 10 will be used.</span>
<span class="sd">    Then, all the star images will be sumed with the background image.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    image_path : str</span>
<span class="sd">        The path where the FITS file will be saved.</span>
<span class="sd">    number_stars: int, optional</span>
<span class="sd">        The number of stars in the image.</span>
<span class="sd">    seeing : float, optional</span>
<span class="sd">        The seeing of the star.</span>
<span class="sd">    seed: float, optinal.</span>
<span class="sd">        The seed used to create the image. Default to 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_integrate_sed</span><span class="p">()</span>
    <span class="n">ord_ray</span><span class="p">,</span> <span class="n">extra_ord_ray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span><span class="p">)</span>
        <span class="n">ord_ray</span><span class="p">,</span> <span class="n">extra_ord_ray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">star_photons_per_second</span>

    <span class="n">image_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccd_operation_mode</span><span class="p">[</span><span class="s2">&quot;image_size&quot;</span><span class="p">]</span>
    <span class="n">star_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_stars</span><span class="p">):</span>
        <span class="n">x_coord</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">image_size</span><span class="p">)</span>
        <span class="n">y_coord</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">image_size</span><span class="p">)</span>
        <span class="n">ordinary_ray</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ord_ray</span><span class="p">)</span>
        <span class="n">extra_ordinary_ray</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">extra_ord_ray</span><span class="p">)</span>
        <span class="n">star_image</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PSF_obj</span><span class="o">.</span><span class="n">create_star_image</span><span class="p">(</span>
            <span class="p">(</span><span class="n">x_coord</span><span class="p">,</span> <span class="n">y_coord</span><span class="p">),</span>
            <span class="n">ordinary_ray</span><span class="p">,</span>
            <span class="n">extra_ordinary_ray</span><span class="p">,</span>
            <span class="n">seeing</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">background</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BGI_obj</span><span class="o">.</span><span class="n">create_sky_background</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sky_photons_per_second</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_name</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
    <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HDR_obj</span><span class="o">.</span><span class="n">create_header</span><span class="p">()</span>
    <span class="n">header</span><span class="p">[</span><span class="s2">&quot;OBSTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OBJECT&quot;</span>
    <span class="n">header</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span>
    <span class="n">header</span><span class="p">[</span><span class="s2">&quot;SHUTTER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OPEN&quot;</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
        <span class="n">file</span><span class="p">,</span>
        <span class="n">background</span> <span class="o">+</span> <span class="n">star_image</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_sky_sed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_sky_sed</span><span class="p">(</span><span class="n">moon_phase</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Create the Spectral Energy Distribution of the sky.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>moon_phase</code></td>
            <td>
                  <code>[new, &#39;first quarter&#39;, &#39;third quarter&#39;, full]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The phase of the moon.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_sky_sed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moon_phase</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the Spectral Energy Distribution of the sky.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    moon_phase : [&#39;new&#39;, &#39;first quarter&#39;, &#39;third quarter&#39;, &#39;full&#39;]</span>
<span class="sd">        The phase of the moon.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sky_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SKY_obj</span><span class="o">.</span><span class="n">calculate_sed</span><span class="p">(</span><span class="n">moon_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.create_source_sed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_source_sed</span><span class="p">(</span><span class="n">calculation_method</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="n">wavelength_interval</span><span class="o">=</span><span class="p">(),</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spectral_type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Create the Spectral Energy Distribution of the source.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>calculation_method</code></td>
            <td>
                  <code>[blackbody, spectral_library]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method used to calculate the SED.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>magnitude</code></td>
            <td>
                  <code>int | float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The magnitude of the astronomical object in the V band.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>wavelength_interval</code></td>
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wavelength interval, in nm, of the astronomical object.
This parameter must be a tuple with three elements, where the first
element is the initial wavelength, the second element is the final
wavelength and the third element is the number of elements in the array.
This parameter is used only if the calculation_method is 'blackbody'.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>temperature</code></td>
            <td>
                  <code>int | float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The blackbody temperature of the astronomical object in Kelvin.
This parameter is used only if the calculation_method is 'blackbody'.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>spectral_type</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectral type of the star that will be used to calculate the SED.
This parameter is used only if the calculation_method is 'spectral_standard'.
The available spectral types can be found using the
<code>print_available_spectral_types()</code> method.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_source_sed</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">calculation_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">magnitude</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">wavelength_interval</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">spectral_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the Spectral Energy Distribution of the source.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    calculation_method : [&#39;blackbody&#39;, &#39;spectral_library&#39;]</span>
<span class="sd">        The method used to calculate the SED.</span>

<span class="sd">    magnitude : int | float</span>
<span class="sd">        The magnitude of the astronomical object in the V band.</span>

<span class="sd">    wavelength_interval : tuple, optional</span>
<span class="sd">        The wavelength interval, in nm, of the astronomical object.</span>
<span class="sd">        This parameter must be a tuple with three elements, where the first</span>
<span class="sd">        element is the initial wavelength, the second element is the final</span>
<span class="sd">        wavelength and the third element is the number of elements in the array.</span>
<span class="sd">        This parameter is used only if the calculation_method is &#39;blackbody&#39;.</span>

<span class="sd">    temperature : int | float, optional</span>
<span class="sd">        The blackbody temperature of the astronomical object in Kelvin.</span>
<span class="sd">        This parameter is used only if the calculation_method is &#39;blackbody&#39;.</span>

<span class="sd">    spectral_type : str, optional</span>
<span class="sd">        The spectral type of the star that will be used to calculate the SED.</span>
<span class="sd">        This parameter is used only if the calculation_method is &#39;spectral_standard&#39;.</span>
<span class="sd">        The available spectral types can be found using the</span>
<span class="sd">        `print_available_spectral_types()` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">calculate_sed</span><span class="p">(</span>
        <span class="n">calculation_method</span><span class="p">,</span>
        <span class="n">magnitude</span><span class="p">,</span>
        <span class="n">wavelength_interval</span><span class="p">,</span>
        <span class="n">temperature</span><span class="p">,</span>
        <span class="n">spectral_type</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.print_available_spectral_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_available_spectral_types</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Print the available spectral types.</p>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">print_available_spectral_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the available spectral types.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">SRC_obj</span><span class="o">.</span><span class="n">print_available_spectral_types</span><span class="p">()</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="Artificial_Image_Simulator.artificial_image_simulator.Artificial_Image_Simulator.write_source_sed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_source_sed</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">sed</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Write a customized source SED into the class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>wavelength</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wavelength interval of the source in nm.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sed</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spectral Energy Distribution of the source in W/(m2.m).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>AIS\Artificial_Image_Simulator\artificial_image_simulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_source_sed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">sed</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a customized source SED into the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength: array like</span>
<span class="sd">        The wavelength interval of the source in nm.</span>
<span class="sd">    sed: array like</span>
<span class="sd">        Spectral Energy Distribution of the source in W/(m2.m).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">sed</span><span class="o">.</span><span class="n">shape</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="n">sed</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_sed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>